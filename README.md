# TikhonovFenichelReductions.jl

A Julia package for computing Tikhonov-Fenichel Parameter Values (TFPVs) for a
polynomial ODE system and the corresponding reductions (see [1-3] for details).

*This package is still under development!*

## Background
Consider an ODE system of the form 
```math
\dot{x} = f(x,\pi, \varepsilon), \quad x(0)=x_0, x \in U\subseteq\mathbb{R}^n, \pi \in \Pi \subseteq \mathbb{R}^m,
```
where $f \in \mathbb{R}[x,\pi]$ is polynomial and $\varepsilon \geq 0$ is a small
parameter. The results from [1-3] allow us to compute a reduced system for
$`\varepsilon \to 0`$ in the sense of Tikhonov [4] and Fenichel [5] using
methods from commutative algebra and algebraic geometry. 

TikhonovFenichelReductions.jl implements methods for finding all possible TFPV
candidates, i.e. separations of parameters into small and large (which in turn
correspond to slow-fast separations of processes in the original system).

## Usage
### Finding TFPV candidates
The main functionality is:
~~~
# Setup
problem = ReductionProblem(f, x, θ, s, idx_slow_fast)

# Compute TFPV candidates
idx, G, V = tfpv_candidates(problem)
~~~
This sets up the problem. The input is a (Julia) function `f(x,θ)` and a vector
of strings defining the dynamic variables $x$ and parameters $\theta$,
respectively. $f$ needs to be a multivariate polynomial in $x$ and $\theta$
defining the RHS of the original system. The dimension of the reduced system is
$`s < n`$.  `π=θ[idx_slow_fast]` are the parameters that should be considered
to be either small or large, i.e. all other parameters are fixed. 

The output is a vector of boolean indices `idx`, where `0`corresponds to a
small and `1` to a large parameter. 
`G` is a Gröbner basis of an ideal in $\mathbb{R}[\pi]$. All TFPVs are
contained in the affine variety of `G`. 
`V`contains the generators of primary ideals that correspond to the irreducible
components of the affine variety $\mathcal{V}(f(\cdot,\pi))$. 
If finding TFPV candidates takes too long, you can disable the computation of
irreducible components of `V` by setting `compute_primary_decomposition=false`.

The functions 
~~~
print_tfpv(idx, prob)
print_varieties(V, prob)
~~~
print out the results in a simple format directly to the REPL. 
You can use the additional argument `latex=true` to print output as LaTeX source
code. 

#### Limitations

The method `tfpv_candidates` can only find TFPV candidates for which a subset of
the original parameters is set to zero. 
For more complicated candidates, i.e. when some function of the parameters is small, 
one has to consider the Gröbner Basis `G` directly.
These 'alternative TFPVs' are rational functions whose vanishing results in the
vanishing of `G`.

### Computing the reduced system

To compute the reduced system, we first need to make the variables available in
the main namespace (parsed to the appropriate types from `Oscar.jl`).
These can be accessed as `problem.x` and `problem.θ`. 
Then, we initialise a reduction by constructing an object of type `Reduction`. 
For the first slow-fast separation in `idx`, this can be done with 
~~~
reduction = Reduction(prob, idx[1])
~~~
Looking at `V[1]`, we can see what a possible slow manifold should be, 
since it is contained in the vanishing set of the ideal generated by the
polynomials in `V[1]`.

Before we can compute the reduced system, we can check if the necessary
conditions for its existence are satisfied. These can be found in [1-3].
Essentially, we need to find a manifold of dimension $s$ contained in
$\mathcal{V}(f(\cdot, \theta^\star))$, a non-singular point $x_0$ on this
manifold and a local product decomposition 
$f(\cdot, \theta^\star) = P\cdot \psi$.

~~~
# define the slow manifold M₀ (M₀ has to have the same format as problem.x)
set_manifold!(reduction, M₀)

# choose a non-singular point x₀ on M₀
set_point!(reduction, x₀)

# define a product decomposion f⁰ = P⋅ψ, where ψ is a matrix of polynomials
# locally satisfying V(ψ) = V(f⁰). 
# (when r = 1, it is sufficient to specify ψ)
set_decomposition!(reduction, P, ψ)
~~~
If all the conditions for the slow manifold, the non-singular point and the
product decomposition are satisfied (indicated by the return value `true` of
each function), we can compute the reduced system with
~~~
g_raw, g = compute_reduction(reduction)
~~~
where `g` corresponds to the RHS of the reduced system on `M₀`.
`g_raw` is the same function, but before substituting the reduced dynamic variables.

## Example
Have a look at the file `example.jl`, which uses this package to compute all
TFPVs as discussed in [6] and computes the Rosenzweig-MacArthur model as a
reduction from a three dimensional system.

## Installation
Run
~~~
add https://gitlab.com/jo-ap/tikhonovfenichelreductions.jl
~~~
in Julia package Mode.
 
## References
[1] A. Goeke and S. Walcher, ‘Quasi-Steady State: Searching for and Utilizing Small Parameters’, in Recent Trends in Dynamical Systems, A. Johann, H.-P. Kruse, F. Rupp, and S. Schmitz, Eds., in Springer Proceedings in Mathematics & Statistics, vol. 35. Basel: Springer Basel, 2013, pp. 153–178. doi: [10.1007/978-3-0348-0451-6_8](http://link.springer.com/10.1007/978-3-0348-0451-6_8).

[2] A. Goeke and S. Walcher, ‘A constructive approach to quasi-steady state reductions’, J Math Chem, vol. 52, no. 10, pp. 2596–2626, Nov. 2014, doi: [10.1007/s10910-014-0402-5](http://link.springer.com/10.1007/s10910-014-0402-5).

[3] A. Goeke, S. Walcher, and E. Zerz, ‘Determining “small parameters” for quasi-steady state’, Journal of Differential Equations, vol. 259, no. 3, pp. 1149–1180, Aug. 2015, doi: [10.1016/j.jde.2015.02.038](https://linkinghub.elsevier.com/retrieve/pii/S0022039615001102).

[4] A. N. Tikhonov, ‘Systems of differential equations containing small parameters in the derivatives’, Mat. Sb. (N.S.), vol. 73, no. 3, pp. 575--586, 1952, <https://www.mathnet.ru/php/archive.phtml?wshow=paper&jrnid=sm&paperid=5548&option_lang=eng>.

[5] N. Fenichel, ‘Geometric singular perturbation theory for ordinary differential equations’, Journal of Differential Equations, vol. 31, no. 1, pp. 53–98, Jan. 1979, doi: [10.1016/0022-0396(79)90152-9](https://linkinghub.elsevier.com/retrieve/pii/0022039679901529)

[6] N. Kruff, C. Lax, V. Liebscher, and S. Walcher, ‘The Rosenzweig–MacArthur system via reduction of an individual based model’, J. Math. Biol., vol. 78, no. 1–2, pp. 413–439, Jan. 2019, doi: [10.1007/s00285-018-1278-y](http://link.springer.com/10.1007/s00285-018-1278-y).

## Dependencies
This packages only works due to the great [Oscar.jl](https://www.oscar-system.org/) project.

## License
GNU GENERAL PUBLIC LICENSE, Version 3 or later (see LICENSE)
