<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting Started Â· TikhonovFenichelReductions.jl</title><meta name="title" content="Getting Started Â· TikhonovFenichelReductions.jl"/><meta property="og:title" content="Getting Started Â· TikhonovFenichelReductions.jl"/><meta property="twitter:title" content="Getting Started Â· TikhonovFenichelReductions.jl"/><meta name="description" content="Documentation for TikhonovFenichelReductions.jl."/><meta property="og:description" content="Documentation for TikhonovFenichelReductions.jl."/><meta property="twitter:description" content="Documentation for TikhonovFenichelReductions.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TikhonovFenichelReductions.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TikhonovFenichelReductions.jl</a></li><li class="is-active"><a class="tocitem" href>Getting Started</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Example"><span>Example</span></a></li></ul></li><li><a class="tocitem" href="../api/">API Reference</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Getting Started</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting Started</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jo-ap/TikhonovFenichelReductions.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ï‚›</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jo-ap/TikhonovFenichelReductions.jl/blob/main/docs/src/gettingstarted.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ï„</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Getting-Started"><a class="docs-heading-anchor" href="#Getting-Started">Getting Started</a><a id="Getting-Started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Started" title="Permalink"></a></h1><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>Run</p><pre><code class="nohighlight hljs">add https://github.com/jo-ap/tikhonovfenichelreductions.jl</code></pre><p>in Julia package Mode.</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>Here we consider the derivation of the Rosenzweig-MacArthur model as a reduction from a three dimensional system as demonstrated in [<a href="../references/#kruff2019">6</a>]. </p><p>Load the package and its dependency <a href="https://www.oscar-system.org/">Oscar.jl</a>.  Note that loading Oscar is optional, but results in prettier printing of types. </p><pre><code class="language-julia hljs">using Oscar
using TikhonovFenichelReductions</code></pre><p>Define the components, parameters and the RHS of the system. </p><pre><code class="language-julia hljs"># components
x = [&quot;B&quot;, &quot;S&quot;, &quot;H&quot;]

# parameters
Î¸ = [&quot;Î±&quot;, &quot;Î²&quot;, &quot;Î³&quot;, &quot;Î´&quot;, &quot;Î·&quot;, &quot;Ï&quot;]

# RHS of ODE system xÌ‡ = f(x, Î¸), where f is polynomial in x and Î¸
function f(x, Î¸)
  B, S, H = x
  Î±, Î², Î³, Î´, Î·, Ï = Î¸
  return [
    Ï*B*(1-B) - Î±*B*H,
    -Î·*S + Î³*B*H,
    Î²*S- Î´*H + Î·*S - Î³*B*H
  ]
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">f (generic function with 1 method)</code></pre><p>Initialize the problem with desired dimension of the reduced system</p><pre><code class="language-julia hljs"># dimension of the reduced system
s = 2

# create problem
prob = ReductionProblem(f, x, Î¸, s)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ReductionProblem(Nemo.QQMPolyRingElem[-B^2*Ï - B*H*Î± + B*Ï, B*H*Î³ - S*Î·, -B*H*Î³ + S*Î² + S*Î· - H*Î´], Nemo.QQMPolyRingElem[B, S, H], Nemo.QQMPolyRingElem[Î±, Î², Î³, Î´, Î·, Ï], 2, Nemo.QQMPolyRingElem[Î±, Î², Î³, Î´, Î·, Ï], Bool[1, 1, 1, 1, 1, 1], [-2*B*Ï-H*Î±+Ï 0 -B*Î±; H*Î³ -Î· B*Î³; -H*Î³ Î²+Î· -B*Î³-Î´], Main.f)</code></pre><p>Compute all TFPV candidates by using necessary conditions for the existence of a reduction.  These are the vanishing of polynomial expressions arising from determinants of minors of the Jacobian and the Krull dimension of the variety containing the slow manifold. </p><pre><code class="language-julia hljs">idx, G, (V, dim_Y) = tfpv_candidates(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(Vector{Bool}[[0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 1, 0], [0, 0, 0, 1, 0, 0], [0, 0, 1, 0, 0, 0], [0, 0, 1, 0, 0, 1], [0, 0, 1, 0, 1, 0], [0, 0, 1, 1, 0, 0], [0, 1, 0, 0, 0, 0], [0, 1, 0, 0, 1, 0], [0, 1, 0, 1, 0, 0], [1, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 1], [1, 0, 0, 1, 0, 0], [1, 0, 1, 0, 0, 0], [1, 0, 1, 0, 0, 1], [1, 0, 1, 1, 0, 0]], Nemo.QQMPolyRingElem[Î´*Î·*Ï, Î³*Î´*Ï, Î²*Î³*Ï - 2*Î´*Î·*Ï, Î±*Î´*Î·], (Any[Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[B], [B - 1]], Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[S]], Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[H]], Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[H], [B]], Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[B], [H, B - 1]], Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[Î³*B*H - Î·*S]], Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[H]], Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[S]], Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[S]], Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[S - Î´//Î²*H]], Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[H], [B]], Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[B], [Ï*B + Î±*H - Ï]], Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[H]], Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[H], [B]], Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[B], [H, B - 1]], Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}[[H]]], [[2, 2], [2], [2], [2, 2], [2, 1], [2], [2], [2], [2], [2], [2, 2], [2, 2], [2], [2, 2], [2, 1], [2]]))</code></pre><p>Show the results: All possible slow-fast separation of rates</p><pre><code class="language-julia hljs">print_candidates(idx, prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Ï€Ìƒ   = (Î±, Î², Î³, Î´, Î·, Ï)
---------------------------
Ï€â‚  = (0, 0, 0, 0, 0, Ï)
Ï€â‚‚  = (0, 0, 0, 0, Î·, 0)
Ï€â‚ƒ  = (0, 0, 0, Î´, 0, 0)
Ï€â‚„  = (0, 0, Î³, 0, 0, 0)
Ï€â‚…  = (0, 0, Î³, 0, 0, Ï)
Ï€â‚†  = (0, 0, Î³, 0, Î·, 0)
Ï€â‚‡  = (0, 0, Î³, Î´, 0, 0)
Ï€â‚ˆ  = (0, Î², 0, 0, 0, 0)
Ï€â‚‰  = (0, Î², 0, 0, Î·, 0)
Ï€â‚â‚€ = (0, Î², 0, Î´, 0, 0)
Ï€â‚â‚ = (Î±, 0, 0, 0, 0, 0)
Ï€â‚â‚‚ = (Î±, 0, 0, 0, 0, Ï)
Ï€â‚â‚ƒ = (Î±, 0, 0, Î´, 0, 0)
Ï€â‚â‚„ = (Î±, 0, Î³, 0, 0, 0)
Ï€â‚â‚… = (Î±, 0, Î³, 0, 0, Ï)
Ï€â‚â‚† = (Î±, 0, Î³, Î´, 0, 0)</code></pre><p>the corresponding irreducible components containing the slow manifold</p><pre><code class="language-julia hljs">print_varieties(V, prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Vâ‚  = ğ‘‰(B) âˆª ğ‘‰(B - 1)
Vâ‚‚  = ğ‘‰(S)
Vâ‚ƒ  = ğ‘‰(H)
Vâ‚„  = ğ‘‰(H) âˆª ğ‘‰(B)
Vâ‚…  = ğ‘‰(B) âˆª ğ‘‰(H, B - 1)
Vâ‚†  = ğ‘‰(Î³*B*H - Î·*S)
Vâ‚‡  = ğ‘‰(H)
Vâ‚ˆ  = ğ‘‰(S)
Vâ‚‰  = ğ‘‰(S)
Vâ‚â‚€ = ğ‘‰(S - Î´//Î²*H)
Vâ‚â‚ = ğ‘‰(H) âˆª ğ‘‰(B)
Vâ‚â‚‚ = ğ‘‰(B) âˆª ğ‘‰(Ï*B + Î±*H - Ï)
Vâ‚â‚ƒ = ğ‘‰(H)
Vâ‚â‚„ = ğ‘‰(H) âˆª ğ‘‰(B)
Vâ‚â‚… = ğ‘‰(B) âˆª ğ‘‰(H, B - 1)
Vâ‚â‚† = ğ‘‰(H)</code></pre><p>and their Krull dimension</p><pre><code class="language-julia hljs">dim_Y</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">16-element Vector{Vector{Int64}}:
 [2, 2]
 [2]
 [2]
 [2, 2]
 [2, 1]
 [2]
 [2]
 [2]
 [2]
 [2]
 [2, 2]
 [2, 2]
 [2]
 [2, 2]
 [2, 1]
 [2]</code></pre><p>For further use, we need to make the variables (the system components and parameters) available in the Main namespace. Here we compute the reduction corresponding to TFPV 16, which is the  Rosenzweig-MacArthur model.</p><pre><code class="language-julia hljs">B, S, H = prob.x
Î±, Î², Î³, Î´, Î·, Ï = prob.Î¸

# instantiate reduction
reduction = Reduction(prob, idx[16])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Reduction(Bool[1, 0, 1, 1, 0, 0], 2, Multivariate polynomial ring in 9 variables over QQ, Nemo.QQMPolyRingElem[B, S, H], Nemo.QQMPolyRingElem[Î±, Î², Î³, Î´, Î·, Ï], Nemo.QQMPolyRingElem[Î±, 0, Î³, Î´, 0, 0], Nemo.QQMPolyRingElem[Î±, Î², Î³, Î´, Î·, Ï], Bool[1, 1, 1, 1, 1, 1], Nemo.QQMPolyRingElem[-B^2*Ï - B*H*Î± + B*Ï, B*H*Î³ - S*Î·, -B*H*Î³ + S*Î² + S*Î· - H*Î´], Nemo.QQMPolyRingElem[-B*H*Î±, B*H*Î³, -B*H*Î³ - H*Î´], Nemo.QQMPolyRingElem[-B^2*Ï + B*Ï, -S*Î·, S*Î² + S*Î·], [-2*B*Ï-H*Î±+Ï 0 -B*Î±; H*Î³ -Î· B*Î³; -H*Î³ Î²+Î· -B*Î³-Î´], [-2*B*Ï-H*Î±+Ï 0 -B*Î±; H*Î³ -Î· B*Î³; -H*Î³ Î²+Î· -B*Î³-Î´], Univariate polynomial ring in Î» over fraction field, 0, AbstractAlgebra.Generic.FracFieldElem{Nemo.QQMPolyRingElem}[B, S, H], AbstractAlgebra.Generic.FracFieldElem{Nemo.QQMPolyRingElem}[0, 0, 0], Fraction field of multivariate polynomial ring, [0; 0; 0], [0], [0 0 0], Bool[0, 0, 0])</code></pre><p>To find the slow manifold, we can consider the affine variety.</p><pre><code class="language-julia hljs">V[16]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Vector{AbstractAlgebra.Generic.MPoly{AbstractAlgebra.Generic.RationalFunctionFieldElem{Nemo.QQFieldElem, Nemo.QQMPolyRingElem}}}}:
 [H]</code></pre><p>This means the slow manifold is  <span>$\mathcal{V}(f^{(0)}) = \mathcal{V}(H) = \{(B,S,0) \mid B,S \in \mathbb{R}\}$</span>, since there is only one component with dimension <span>$s=2$</span> as desired:</p><pre><code class="language-julia hljs">dim_Y[16]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Int64}:
 2</code></pre><p>Therefore, we can set the slow manifold accordingly.</p><pre><code class="language-julia hljs">set_manifold!(reduction, [B, S, 0])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>Note that in this case any generic point on the affine variety is non-singular and can be chosen.   Thus, we don&#39;t have to call <code>set_point!</code> to set a non-singular point explicitly on whose neighbourhood the reduction exists. </p><p>Lastly, we define a product decomposition <span>$f^{(0)} = P \cdot \psi$</span> with  <span>$\mathcal{V}(\psi) = \mathcal{V}(f^{(0)})$</span> in some neighbourhood.  This can always be done by specifying only <span>$\psi$</span> if <span>$n-s=1$</span>, as is the case here:</p><pre><code class="language-julia hljs">set_decomposition!(reduction, [H])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>Now we can compute the reduced system.</p><pre><code class="language-julia hljs">_, g = compute_reduction(reduction)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(AbstractAlgebra.Generic.FracFieldElem{Nemo.QQMPolyRingElem}[(-B^3*Î³*Ï + B^2*Î³*Ï - B^2*Î´*Ï - B*S*Î±*Î² - B*S*Î±*Î· + B*Î´*Ï)//(B*Î³ + Î´), (B*S*Î²*Î³ - S*Î´*Î·)//(B*Î³ + Î´), 0], AbstractAlgebra.Generic.FracFieldElem{Nemo.QQMPolyRingElem}[(-B^3*Î³*Ï + B^2*Î³*Ï - B^2*Î´*Ï - B*S*Î±*Î² - B*S*Î±*Î· + B*Î´*Ï)//(B*Î³ + Î´), (B*S*Î²*Î³ - S*Î´*Î·)//(B*Î³ + Î´), 0])</code></pre><p>The first two components define the reduced system and can be rewritten as </p><p class="math-container">\[\begin{align*}
\frac{dB}{dt} &amp;= \rho B (1 - B) - \alpha(\eta + \beta) S \frac{B}{\delta + \gamma B} \\
\frac{dS}{dt} &amp;= -\eta S + \gamma(\eta + \beta) S \frac{B}{\delta + \gamma B} \\
\end{align*}\]</p><p>which is exactly the Rosenzweig-MacArthur model.</p><p>The slow manifold is attractive if all non-zero eigenvalues of the Jacobian at the non-singular <code>xâ‚€</code> point have negative real part. </p><pre><code class="language-julia hljs">reduction.Df_xâ‚€</code></pre>[0 0 -B*Î±; 0 0 B*Î³; 0 0 -B*Î³-Î´]<p>Thus, the full system converges to the reduction as <span>$\varepsilon \to 0$</span> if  <span>$B &gt; \frac{\delta}{\gamma}$</span>. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">Â« TikhonovFenichelReductions.jl</a><a class="docs-footer-nextpage" href="../api/">API Reference Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Tuesday 21 May 2024 08:04">Tuesday 21 May 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
